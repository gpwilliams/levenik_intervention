---
title: "Results"
author: "Glenn Williams"
date: "14<sup>th</sup> August, 2019 (Last updated: `r format(Sys.time(), '%d<sup>th</sup> %B, %Y')`)"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: united
bibliography: [r-references.bib, main-references.bib]
csl: apa6.csl
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)

packages <- c(
  "tidyverse",
  "rlang",
  "here",
  "brms",
  "tidybayes",
  "bayestestR",
  "modelr",
  "ggforce",
  "ggrepel",
  "ggridges",
  "irr",
  "papaja" # install with devtools::install_github("crsh/papaja")
)

# load packages
lapply(packages, library, character.only = TRUE)

# load functions
r_function_list <- list.files(
  path = here("R", "00_functions"), 
  pattern = "R$",
  full.names = TRUE
)
purrr::walk(r_function_list, source)

# get citations
citations <- purrr::map(packages, citation)

# get file paths ----

# get model summaries only for easy loading
fitted_models_dir <- list.files(
  path = here("04_analysis", "01_models"),
  pattern = "rds$",
  full.names = TRUE
) %>% 
  str_subset("summary")
  

model_summaries_dir <- list.files(
  path = here("04_analysis", "02_summaries", "02_posterior-full-data"),
  pattern = "csv$",
  full.names = TRUE
)

plot_titles <- "01_with-titles" # can also be "02_without-titles"
plots_dir <- list.files(
  path = c(
    here("03_plots", "02_posterior-full-data", plot_titles),
    here("03_plots", "03_main-data-summary", plot_titles), 
    here("03_plots", "04_exploratory", plot_titles)
  ),
  pattern = "png$",
  full.names = TRUE
)

# load data ----

fitted_models <- purrr::map(fitted_models_dir, read_rds)

names(fitted_models) <- fitted_models_dir %>% 
  sub(".*/", "", .) %>% 
  substr(., 1, nchar(.)-4)

model_summaries <- purrr::map(model_summaries_dir, read_csv)
names(model_summaries) <- model_summaries_dir %>% 
  sub(".*/", "", .) %>% 
  substr(., 1, nchar(.)-4)
```

```{r define-renaming-variables}
summary_oldnames <- c(".value", "interval")
summary_newnames <- c("median", "credible interval")
summary_drop <- c(".point", ".interval")

posterior_oldnames <- c("Ci Interval", "Rope Interval", "Pd")
posterior_newnames <- c("Credible Interval", "HDI Interval", "P(Direction)")
posterior_drop <- c(
  ".width",
  ".point",
  ".interval",
  "CI",
  "ROPE_low", 
  "ROPE_high",
  "ROPE_Equivalence"
)
```

```{r get-citations}
my_citations <- papaja::cite_r(
  file = here("05_reports", "r-references.bib"), 
  pkgs = packages, 
  withhold = FALSE
)
```

`r my_citations` were used for data preparation, analysis, and presentation.

# Additional Statistics for Reported Analyses

Here, we report additional statistics for the model summaries reported in the main body of the manuscript. Namely, we report tables of summary statistics for the parameter estimates of the joint posterior for the marginal effects reported within each analysis (i.e. depicted in the first plot of each subsection).

Additionally, we report further hypothesis tests for the comparison between levels of factors within each analysis. These are reported in the form of Region of Practical Equivalence (ROPE) analyses from these draws also using the bayestestR R-package [@R-bayestestR]. This defines an area around the point null that is practically equivalent to zero for assessing evidence in support of the null hypothesis [@kruschke2014doing; @kruschke2018rejecting]. Here, the bounds of the ROPE range are defined as half the smallest effect reported in the @williams2020does parameter estimates and intervals report the 90% highest density interval (HDI) of the posterior. We report the proportion of the HDI contained within the ROPE region along with bounds of this interval. Where HDIs are entirely contained by the equivalence bounds, equivalence is accepted. Where HDIs are entirely outside the equivalence bounds, equivalence is rejected. Uncertainty is assigned to any HDIs that cross the equivalence bounds in either (or both) directions. The HDI differs from the equal tailed intervals used for summary statistics in that values within the range are always more probable than values outside of the range, and the interval need not exclude an equal amount of the distribution towards both tails. With symmetric distributions, the two methods produce similar results. For completeness, we report for 90% CIs and HDIs.

The ROPE range used for this analysis was determined after having completed the pre-registered analyses, and as such can be seen as an exploratory analysis only. Caution is encouraged when interpreting these results. In comparison, the *pd*, while also not pre-registered, is less open to manipulation from researcher degrees of freedom given as no judgment has to be made on how it is determined.

## Vocabulary Testing Phase Model

### Word Type by Exposure Condition

Posterior medians and credible intervals summaries of the depicted effects are provided in the table below.

```{r variety-word-type-exposure}
format_summary_table(
  model_summaries$exposure_vw, 
  summary_oldnames, 
  summary_newnames,
  .drop = summary_drop
  ) %>% 
  filter(.Width == 0.90) %>% 
  select(-.Width) %>% 
  custom_kable()
```

We also report the poterior medians, equal tailed percentile credible intervals, HDI intervals, *pd*, and ROPE percentage (i.e. how much of the posterior is contained by the ROPE range) below.

```{r variety-word-type-exposure-compare}
report_posteriors(
  model_summaries$exposure_vw_compare,
  model_summaries$exposure_vw_compare_rope,
  .width = 0.9,
  posterior_drop,
  posterior_oldnames,
  posterior_newnames
) %>% 
  custom_kable(
    ., 
    caption = NULL, 
    add_footer = TRUE, 
    model_summaries$exposure_vw_compare_rope
  )
```

## Testing Phase Model

### Word Type by Task and Exposure Condition

Posterior medians and credible interval summaries of the depicted effects are provided in the table below.

```{r task-variety-word-type-testing}
format_summary_table(
  model_summaries$testing_tvw, 
  summary_oldnames, 
  summary_newnames,
  .drop = summary_drop
  ) %>% 
  filter(.Width == 0.90) %>% 
  select(-.Width) %>% 
  custom_kable()
```

We also report the poterior medians, equal tailed percentile credible intervals, HDI intervals, *pd*, and ROPE percentage (i.e. how much of the posterior is contained by the ROPE range) below.

```{r task-variety-word-type-testing-compare}
report_posteriors(
  model_summaries$testing_tvw_compare,
  model_summaries$testing_tvw_compare_rope,
  .width = 0.9,
  .drop = posterior_drop,
  .oldnames = posterior_oldnames,
  .newnames = posterior_newnames
) %>% 
  custom_kable(
    ., 
    caption = NULL,
    add_footer = TRUE, 
    model_summaries$testing_tvw_compare_rope
  )
```

### Novel Words by Task and Exposure Condition

Posterior medians and credible interval summaries of the depicted effects are provided in the table below.

```{r task-variety-novel-testing}
format_summary_table(
  model_summaries$testing_tv_n, 
  summary_oldnames, 
  summary_newnames,
  .drop = summary_drop
  ) %>% 
  filter(.Width == 0.90) %>% 
  select(-.Width) %>% 
  custom_kable()
```

We also report the poterior medians, equal tailed percentile credible intervals, HDI intervals, *pd*, and ROPE percentage (i.e. how much of the posterior is contained by the ROPE range) below.

```{r task-variety-novel-testing-compare}
report_posteriors(
  model_summaries$testing_tv_n_compare,
  model_summaries$testing_tv_n_compare_rope,
  .width = 0.9,
  posterior_drop,
  posterior_oldnames,
  posterior_newnames
) %>% 
  custom_kable(
    ., 
    caption = NULL, 
    add_footer = TRUE, 
    model_summaries$testing_tv_n_compare_rope
  )
```

## Exploratory Covariate Testing Model

### Word Type by Task, Exposure Condition, and a Median Split of Vocabulary Test Performance

Posterior medians and credible interval summaries of the depicted effects are provided in the table below.

```{r cov-task-variety-word-type-covariate-ms}
format_summary_table(
  model_summaries$testing_cov_median_etvw, 
  summary_oldnames, 
  summary_newnames,
  .drop = summary_drop
  ) %>% 
  filter(.Width == 0.90) %>% 
  rename(`Exposure Test nLED Group` = `Exposure Test Nled Group`) %>% 
  select(-.Width) %>% 
  custom_kable()
```

We also report the poterior medians, equal tailed percentile credible intervals, HDI intervals, *pd*, and ROPE percentage (i.e. how much of the posterior is contained by the ROPE range) below. This replicates the results from the second posterior plot for this analysis.

```{r cov-task-variety-word-type-covariate-ms-compare}
report_posteriors(
  model_summaries$testing_cov_median_etvw_compare,
  model_summaries$testing_cov_median_etvw_compare_rope,
  0.9,
  posterior_drop,
  posterior_oldnames,
  posterior_newnames
) %>% 
  rename(`Exposure Test nLED Group` = `Exposure Test Nled Group`) %>% 
  arrange(Task) %>% 
  select(Task, everything()) %>% 
  custom_kable(
    ., 
    caption = NULL, 
    add_footer = TRUE, 
    model_summaries$testing_cov_median_etvw_compare_rope
  )
```

### Novel Words by Task, Exposure Condition, and a Median Split of Vocabulary Test Performance

Posterior medians and credible interval summaries of the depicted effects are provided in the table below.

```{r novel-variety-task-cov-testing-cov}
format_summary_table(
  model_summaries$testing_cov_median_etv_n, 
  summary_oldnames, 
  summary_newnames,
  .drop = summary_drop
  ) %>% 
  rename(`Exposure Test nLED Group` = `Exposure Test Nled Group`) %>%
  arrange(Task) %>% 
  select(Task, everything()) %>% 
  filter(.Width == 0.90) %>% 
  select(-.Width) %>% 
  custom_kable()
```

We also report the poterior medians, equal tailed percentile credible intervals, HDI intervals, *pd*, and ROPE percentage (i.e. how much of the posterior is contained by the ROPE range) below. This replicates the results from the second posterior plot for this analysis.

```{r novel-variety-task-cov-testing-cov-summary}
report_posteriors(
  model_summaries$testing_cov_median_etv_n_compare,
  model_summaries$testing_cov_median_etv_n_compare_rope,
  0.9,
  posterior_drop,
  posterior_oldnames,
  posterior_newnames
) %>% 
  rename(`Exposure Test nLED Group` = `Exposure Test Nled Group`) %>% 
  arrange(Task) %>% 
  select(Task, everything()) %>% 
  custom_kable(
    ., 
    caption = NULL,
    add_footer = TRUE, 
    model_summaries$testing_cov_median_etv_n_compare_rope
  )
```

# Additional Unreported Analyses

This section outlines additional analyses that were pre-registered but not reported in the main body of the manuscript. These analyses were not included because they largely echo the results of the (also pre-registered) effects of Exposure condition within Task for novel words only. Essentially, this analyses (collapsing across all word types) and the analysis for novel words only ask whether there are any effects of dialect exposure on general literacy.

## Testing Phase Model

### Simple Effect of Exposure Condition within Each Task (i.e. Collapsing across all Word Types)

We predicted:

- Overall performance will be better in the Dialect condition relative to the No Dialect condition as exposure to a dialect will push learners towards grapheme-phoneme conversion rather than suboptimal strategies such as whole word reading.

- Overall performance will be better in the Dialect & Social condition relative to the Dialect condition due to the social cue allowing learners to suppress irrelevant language varieties; i.e. the dialect variety when doing the literacy test in the no dialect variety. This should lead to less cognitive load and confusion between varieties.

- Overall performance will be better in the Dialect Literacy condition relative to the Dialect & Social condition due to training in multiple varieties highlighting the alphabetic principle, pushing people to the best strategy earlier on in learning. Additionally, having dialect literacy training may act similar to a cognate effect in bilingual learners in which literacy learning is improved when participants learn two alphabetic languages (e.g. Van Assche, Duyck, Hartsuiker, & Diependaele, 2009).

Posterior medians with 80% and 90% credible intervals are shown collapsing across all words within each task and exposure condition below.

```{r task-variety-testing-plot}
knitr::include_graphics(plots_dir[str_detect(plots_dir, "testing_tv.png")])
```

Here, the most consistent effect is that performance is generally worse on the spelling task relative to the reading task. Posterior medians with 80% and 90% credible intervals are shown for the comparison between each Exposure condition within each Task across all word types below.

```{r task-variety-testing-compare-plot}
knitr::include_graphics(plots_dir[str_detect(plots_dir, "testing_tv_compare.png")])
```

Here, there are no differences across conditions in reading or spelling performance collapsng across all word types. Thus, as with the analysis for novel words only our pre-registered predictions were not supported. As with the novel words only, exposure to a dialect in any form has no overall negative impact on literacy acquisition. 

# References

